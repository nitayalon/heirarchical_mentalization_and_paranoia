group_by(trial_number, dyad,  sender_dom_level, receiver_dom_level,
receiver_threshold, sender_threshold) %>%
mutate(`P(0.0)` = mean(`X0.0`),
`P(0.1)` = mean(`X0.1`),
`P(0.5)` = mean(`X0.5`)) %>%
mutate(`log_prob(0.0)` = log2(`P(0.0)`) * `P(0.0)`,
`log_prob(0.1)` = log2(`P(0.1)`) * `P(0.1)`,
`log_prob(0.5)` = log2(`P(0.5)`) * `P(0.5)`) %>%
summarise(entropy = -(`log_prob(0.0)` + `log_prob(0.1)` + `log_prob(0.5)`)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = entropy, colour=sender_dom_level),
size=1.5) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
ylab("Entropy") +
xlab("Trial number") +
facet_grid(receiver_dom_level~sender_threshold)
# ggsave("../figures/posterior_beliefs_entropy.png", width = 40, height = 20, units = "cm")
beliefs %>%
filter(receiver_dom_level == 0,
agent_name %in% c("DoM(0)_receiver","DoM(2)_receiver")) %>%
mutate(sender_dom_level = factor(sender_dom_level),
sender_threshold = factor(sender_threshold),
receiver_dom_level = factor(receiver_dom_level),
receiver_threshold = factor(receiver_threshold)) %>%
mutate(dyad = fct_cross(sender_dom_level, receiver_dom_level)) %>%
group_by(agent_name, trial_number, dyad,  sender_dom_level, receiver_dom_level,
receiver_threshold, sender_threshold) %>%
mutate(`P(0.0)` = mean(`X0.0`),
`P(0.1)` = mean(`X0.1`),
`P(0.5)` = mean(`X0.5`)) %>%
mutate(`log_prob(0.0)` = log2(`P(0.0)`) * `P(0.0)`,
`log_prob(0.1)` = log2(`P(0.1)`) * `P(0.1)`,
`log_prob(0.5)` = log2(`P(0.5)`) * `P(0.5)`) %>%
summarise(entropy = -(`log_prob(0.0)` + `log_prob(0.1)` + `log_prob(0.5)`)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = entropy, colour=sender_dom_level),
size=1.5) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
ylab("Entropy") +
xlab("Trial number") +
facet_grid(receiver_dom_level~sender_threshold)
# ggsave("../figures/posterior_beliefs_entropy.png", width = 40, height = 20, units = "cm")
beliefs %>%
filter(agent_name %in% c("DoM(0)_receiver","DoM(2)_receiver")) %>%
mutate(sender_dom_level = factor(sender_dom_level),
sender_threshold = factor(sender_threshold),
receiver_dom_level = factor(receiver_dom_level),
receiver_threshold = factor(receiver_threshold)) %>%
mutate(dyad = fct_cross(sender_dom_level, receiver_dom_level)) %>%
group_by(agent_name, trial_number, dyad,  sender_dom_level, receiver_dom_level,
receiver_threshold, sender_threshold) %>%
mutate(`P(0.0)` = mean(`X0.0`),
`P(0.1)` = mean(`X0.1`),
`P(0.5)` = mean(`X0.5`)) %>%
mutate(`log_prob(0.0)` = log2(`P(0.0)`) * `P(0.0)`,
`log_prob(0.1)` = log2(`P(0.1)`) * `P(0.1)`,
`log_prob(0.5)` = log2(`P(0.5)`) * `P(0.5)`) %>%
summarise(entropy = -(`log_prob(0.0)` + `log_prob(0.1)` + `log_prob(0.5)`)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = entropy, colour=sender_dom_level),
size=1.5) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
ylab("Entropy") +
xlab("Trial number") +
facet_grid(receiver_dom_level~sender_threshold)
# ggsave("../figures/posterior_beliefs_entropy.png", width = 40, height = 20, units = "cm")
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 0
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(4, 15)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid, agent == "DoM(0)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
# ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s.png", sender_dom_level_for_plot), width = 40, height = 20, units = "cm")
game_all
q_values
q_values$agent
table(q_values$agent)
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 2
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(4, 15)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid, agent == "DoM(2)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
# ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s.png", sender_dom_level_for_plot), width = 40, height = 20, units = "cm")
game_all
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 2
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(sender_threshold = factor(sender_threshold),
response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(4, 15)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 2
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(15, 4)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid, agent == "DoM(2)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
# ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s.png", sender_dom_level_for_plot), width = 40, height = 20, units = "cm")
game_all
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 0
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(15, 4)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid, agent == "DoM(2)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 0
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(15, 4)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
receiver_dom_level_for_plot
q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot,
sender_dom_level == sender_dom_level_for_plot, seed == sid)
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 0
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(15, 4)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot,
sender_dom_level == sender_dom_level_for_plot, seed == sid,
agent == "DoM(0)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
# ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s.png", sender_dom_level_for_plot), width = 40, height = 20, units = "cm")
game_all
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 0
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(4, 15)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot,
sender_dom_level == sender_dom_level_for_plot, seed == sid,
agent == "DoM(0)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
# ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s.png", sender_dom_level_for_plot), width = 40, height = 20, units = "cm")
game_all
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 0
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
scale_shape_manual(values=c(4, 15)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot,
sender_dom_level == sender_dom_level_for_plot, seed == sid,
agent == "DoM(0)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s_receiver_dom_level_%s.png", sender_dom_level_for_plot, receiver_dom_level_for_plot), width = 40, height = 20, units = "cm")
sid = 210
sender_dom_level_for_plot = 1
receiver_dom_level_for_plot = 2
game_plot <- game_results %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
# mutate(sender_threshold = factor(sender_threshold),
#        response = factor(response, labels = c('reject','accept'))) %>%
mutate(sender_threshold = factor(sender_threshold)) %>%
ggplot(aes(x = trial_number, y = offer)) +
geom_point(aes(shape = factor(response)), size = 1.5) +
geom_line(aes(colour = sender_threshold), alpha=0.5, size = 1.5) +
scale_color_viridis_d(name = expression(paste('Sender threshold')))+
# scale_shape_manual(values=c(4, 15)) +
scale_shape_manual(values=c(15, 4)) +
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('Game results')
belief_plot <- beliefs %>%
filter(receiver_dom_level == receiver_dom_level_for_plot, sender_dom_level == sender_dom_level_for_plot, seed == sid) %>%
mutate(`P(0.0)` = `X0.0`,
`P(0.1)` = `X0.1`,
`P(0.5)` = `X0.5`) %>%
ggplot() +
geom_line(aes(x = trial_number, y = `P(0.0)`, colour='`P(0.0)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.1)`, colour='`P(0.1)`',
linetype = factor(sender_dom_level)),
size=1.0) +
geom_line(aes(x = trial_number, y = `P(0.5)`, colour='`P(0.5)`',
linetype = factor(sender_dom_level)),
size=1.0) +
scale_linetype_manual(values=c("solid", "dotted", "solid"))+
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
facet_grid(receiver_threshold~sender_threshold) +
labs(y = 'Posterior probability', x= 'Trial') +
ggtitle('Belief update')
q_value_plot <- q_values %>%
filter(receiver_dom_level == receiver_dom_level_for_plot,
sender_dom_level == sender_dom_level_for_plot, seed == sid,
agent == "DoM(2)_receiver") %>%
mutate(response = factor(action, labels = c('reject','accept'))) %>%
ggplot(aes(trial_number, q_value, colour = factor(sender_threshold))) +
geom_point(aes(shape = response), size=2.0) +
scale_shape_manual(values=c(4, 15)) +
scale_color_viridis_d(name = expression(paste('P(',gamma, ')')))+
labs(y = 'Offer', x= 'Trial', shape = "Receiver's response") +
ggtitle('DoM(0) receiver Q-values')
game_all = game_plot + belief_plot / q_value_plot
ggsave(sprintf("../figures/simulation_illustration_sender_dom_level_%s_receiver_dom_level_%s.png", sender_dom_level_for_plot, receiver_dom_level_for_plot), width = 40, height = 20, units = "cm")
