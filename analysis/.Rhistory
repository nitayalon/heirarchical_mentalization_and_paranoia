summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Exploration: ',alpha)))+
geom_line(aes(linetype = factor(agent_dom_level)))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(factor(subject_threshold)), cols = vars(factor(agent_threshold)))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(factor(subject_threshold)), cols = vars(factor(agent_threshold))) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
library(tidyverse)
library(here)
library(colorspace)
library(caret)
library(patchwork)
library(plotly)
library(ks)
library(ggpubr)
library(rstatix)
library(corrr)
library(emmeans)
library(effsize)
library(ARTool)
library(car)
# Plotting settings for aliasing on windows
# Enable anti-aliasing on Windows
if(Sys.info()['sysname'] == "Windows"){
trace(grDevices::png, quote({
if (missing(type) && missing(antialias)) {
type <- "cairo-png"
antialias <- "subpixel"
}
}), print = FALSE)
# Enable anti-aliasing on Windows
trace(grDevices:::png, quote({
if (missing(type) && missing(antialias)) {
type <- "cairo-png"
antialias <- "subpixel"
}
}), print = FALSE)
}
# Define general plot style and style
base_size = 15
theme_set(theme_classic(base_size = base_size))
parse_experiment_file <- function(file_name)
{
parameters_list <- strsplit(file_name, "_")[[1]]
alpha = parameters_list[4]
subject_threshold = parameters_list[7]
agent_threshold = parameters_list[10]
return(c(alpha, subject_threshold, agent_threshold))
}
results_path = "~/Max_Planck/Hierarchical-modelling/data/agent_subject/basic_task/"
dom_levels = list(
c("-1","0"),
c("0","-1"),
c("0","0"))
directory_pattern <- "DoM%s_subject_DoM%s_agent_softmax_0.5"
path_to_game_results <- paste0(results_path, directory_pattern)
game_results <- c()
for(dom_level in dom_levels)
{
subject_dom_level = dom_level[1]
agent_dom_level = dom_level[2]
path_to_experiments_results <- sprintf(path_to_game_results, subject_dom_level, agent_dom_level)
path_to_dir <- paste(path_to_experiments_results, "simulation_results" ,sep="/")
temp = list.files(path=path_to_dir, pattern="*.csv")
myfiles = lapply(paste(path_to_dir, temp, sep="/"), read.csv)
interim_results <- bind_rows(myfiles)
game_results <- rbind(game_results, cbind(interim_results, subject_dom_level, agent_dom_level))
}
dom_level
game_results
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(factor(subject_threshold)), cols = vars(factor(agent_threshold))) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(factor(subject_threshold)), cols = vars(factor(agent_threshold))) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(factor(subject_threshold)), cols = vars(factor(agent_threshold)),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
levels(game_results$subject_threshold)
factor(game_results$subject_threshold)
levels(factor(game_results$subject_threshold))
names(threshold_levels)
threshold_levels <- levels(factor(game_results$subject_threshold))
names(threshold_levels)
expression(paste('Opponent awarness: ',alpha))
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = factor(subject_alpha))) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(factor(subject_threshold)), cols = vars(factor(agent_threshold)),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = subject_alpha)) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line() +
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot(aes(x = trial_number, y = subject_reward, colour = subject_alpha)) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
geom_line(size = 1.0) +
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold))
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot(aes(colour = subject_alpha)) +
geom_line(aes(x = trial_number, y = subject_reward, linetype='subject_reward')) +
geom_line(aes(x = trial_number, y = agent_reward, linetype='agent_reward')) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype=subject_alpha, colour='subject_reward'),
size=1.0) +
geom_line(aes(x = trial_number, y = agent_reward, linetype=subject_alpha, colour='agent_reward'),
size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
results_path = "~/Max_Planck/Hierarchical-modelling/data/agent_subject/basic_task/"
dom_levels = list(
c("-1","0"),
c("0","-1"),
c("0","0"))
directory_pattern <- "DoM%s_subject_DoM%s_agent_softmax_0.5"
path_to_game_results <- paste0(results_path, directory_pattern)
game_results <- c()
for(dom_level in dom_levels)
{
subject_dom_level = dom_level[1]
agent_dom_level = dom_level[2]
path_to_experiments_results <- sprintf(path_to_game_results, subject_dom_level, agent_dom_level)
path_to_dir <- paste(path_to_experiments_results, "simulation_results" ,sep="/")
temp = list.files(path=path_to_dir, pattern="*.csv")
myfiles = lapply(paste(path_to_dir, temp, sep="/"), read.csv)
interim_results <- bind_rows(myfiles)
game_results <- rbind(game_results, cbind(interim_results, subject_dom_level, agent_dom_level))
}
game_results %>%
filter(subject_dom_level == "-1", agent_dom_level == "0") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype=subject_alpha, colour='subject_reward'),
size=1.0) +
geom_line(aes(x = trial_number, y = agent_reward, linetype=subject_alpha, colour='agent_reward'),
size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype=subject_alpha, colour='subject_reward'),
size=1.0) +
geom_line(aes(x = trial_number, y = agent_reward, linetype=subject_alpha, colour='agent_reward'),
size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
beliefs <- c()
for(dom_level in dom_levels)
{
subject_dom_level = dom_level[1]
agent_dom_level = dom_level[2]
path_to_experiments_results <- sprintf(path_to_game_results, subject_dom_level, agent_dom_level)
path_to_dir <- paste(path_to_experiments_results, "beliefs" ,sep="/")
temp = list.files(path=path_to_dir, pattern="*.csv")
myfiles = lapply(paste(path_to_dir, temp, sep="/"), read.csv)
interim_results <- bind_rows(myfiles)
beliefs <- rbind(beliefs, cbind(interim_results, subject_dom_level, agent_dom_level))
}
dom_levels
dom_level
agents_beliefs <- c("agent_beliefs", "subject_beliefs")
agents_beliefs
agents_beliefs
agent_name = agents_beliefs]1
agent_name = agents_beliefs[1]
agent_name
paste(path_to_game_results, agent_name, "/")
paste0(path_to_game_results, agent_name, "/")
paste(path_to_game_results, agent_name, sep="/")
sprintf(updated_path, subject_dom_level, agent_dom_level)
updated_path = paste(path_to_game_results, agent_name, sep="/")
path_to_experiments_results <- sprintf(updated_path, subject_dom_level, agent_dom_level)
path_to_experiments_results
path_to_dir <- paste(path_to_experiments_results, "beliefs" ,sep="/")
path_to_dir <- paste(path_to_experiments_results, "beliefs" ,sep="/")
updated_path = paste(path_to_dir, agent_name, sep="/")
path_to_experiments_results <- sprintf(updated_path, subject_dom_level, agent_dom_level)
path_to_dir <- paste(results_path, "beliefs" ,sep="/")
path_to_dir
path_to_experiments_results
path_to_dir
path_to_dir
path_to_experiments_results <- sprintf(path_to_game_results, subject_dom_level, agent_dom_level)
path_to_experiments_results
path_to_dir <- paste(path_to_experiments_results, "beliefs" ,sep="/")
path_to_dir
updated_path = paste(path_to_dir, agent_name, sep="/")
updated_path
temp = list.files(path=updated_path, pattern="*.csv")
temp
myfiles = lapply(paste(updated_path, temp, sep="/"), read.csv)
interim_results
updated_path
interim_results <- bind_rows(myfiles)
interim_results
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype=subject_reward, colour=subject_alpha),
size=1.0) +
geom_line(aes(x = trial_number, y = agent_reward, linetype=agent_reward, colour=subject_alpha),
size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype='subject_reward', colour=subject_alpha),
size=1.0) +
geom_line(aes(x = trial_number, y = agent_reward, linetype='agent_reward', colour=subject_alpha),
size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype='subject_reward', colour=subject_alpha),
size=1.0) +
# geom_line(aes(x = trial_number, y = agent_reward, linetype='agent_reward', colour=subject_alpha),
#           size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
summarise(subject_reward = cumsum(subject_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
summarise(subject_reward = cumsum(subject_reward)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype='subject_reward', colour=subject_alpha),
size=1.0) +
# geom_line(aes(x = trial_number, y = agent_reward, linetype='agent_reward', colour=subject_alpha),
#           size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold, ) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
summarise(subject_reward = cumsum(subject_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
summarise(subject_reward = cumsum(subject_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
summarise(subject_reward = cumsum(subject_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = cumsum(subject_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = cumsum(subject_reward)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = subject_reward, linetype='subject_reward', colour=subject_alpha),
size=1.0) +
# geom_line(aes(x = trial_number, y = agent_reward, linetype='agent_reward', colour=subject_alpha),
#           size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = cumsum(subject_reward))
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = cumsum(subject_reward)) %>%
arrange(subject_threshold, subject_alpha, agent_threshold)
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
mutate(subject_reward = cumsum(subject_reward)) %>%
arrange(subject_threshold, subject_alpha, agent_threshold)
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
mutate(cumulative_subject_reward = cumsum(subject_reward)) %>%
arrange(subject_threshold, subject_alpha, agent_threshold)
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(subject_threshold, subject_alpha, agent_threshold) %>%
mutate(cumulative_subject_reward = cumsum(subject_reward)) %>%
arrange(subject_threshold, subject_alpha, agent_threshold)
game_results %>%
filter(subject_dom_level == "0", agent_dom_level == "-1") %>%
mutate(subject_alpha = factor(subject_alpha),
subject_threshold = factor(subject_threshold),
agent_threshold = factor(agent_threshold)) %>%
group_by(trial_number, subject_threshold, subject_alpha, agent_threshold) %>%
summarise(subject_reward = mean(subject_reward),
agent_reward = mean(agent_reward)) %>%
group_by(subject_threshold, subject_alpha, agent_threshold) %>%
mutate(cumulative_subject_reward = cumsum(subject_reward)) %>%
ggplot() +
geom_line(aes(x = trial_number, y = cumulative_subject_reward, linetype='subject_reward', colour=subject_alpha),
size=1.0) +
# geom_line(aes(x = trial_number, y = agent_reward, linetype='agent_reward', colour=subject_alpha),
#           size=1.0) +
scale_color_viridis_d(name = expression(paste('Opponent awarness: ',alpha)))+
facet_grid(rows = vars(subject_threshold), cols = vars(agent_threshold),
labeller = label_both) +
labs(title = '[Agent DoM = -1 | Subject DoM = 0]', y = 'Subject reward', x= 'Trial')
